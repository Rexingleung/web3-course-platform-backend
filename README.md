# Web3 Course Platform - Backend\n\nè¿™æ˜¯ä¸€ä¸ªåŸºäºæ™ºèƒ½åˆçº¦çš„è¯¾ç¨‹å¹³å°åç«¯æœåŠ¡ï¼Œä½¿ç”¨ Node.js + Express + TypeScript + MySQL æ„å»ºã€‚\n\n## åŠŸèƒ½ç‰¹æ€§\n\n- ğŸ”— ä¸æ™ºèƒ½åˆçº¦é›†æˆï¼ŒåŒæ­¥è¯¾ç¨‹æ•°æ®\n- ğŸ“Š ç”¨æˆ·è´­ä¹°è¯¾ç¨‹è®°å½•\n- ğŸ“ è¯¾ç¨‹ç®¡ç†å’ŒæŸ¥è¯¢\n- ğŸ‘¨â€ğŸ« ä½œè€…è¯¾ç¨‹ç®¡ç†\n- ğŸ—„ï¸ MySQL æ•°æ®åº“å­˜å‚¨\n- ğŸš€ RESTful API æ¥å£\n- ğŸ”„ æ™ºèƒ½åˆçº¦æ•…éšœè½¬ç§»ï¼ˆæ•°æ®åº“åå¤‡ï¼‰\n\n## æŠ€æœ¯æ ˆ\n\n- Node.js + Express\n- TypeScript\n- MySQL2\n- Ethers.js (Web3)\n- CORS\n\n## å¿«é€Ÿå¼€å§‹\n\n### ç¯å¢ƒè¦æ±‚\n\n- Node.js 16+\n- MySQL 5.7+\n- æ™ºèƒ½åˆçº¦å·²éƒ¨ç½²ï¼ˆå¯é€‰ï¼Œæœ‰æ•°æ®åº“åå¤‡ï¼‰\n\n### 1. å®‰è£…ä¾èµ–\n\n```bash\nnpm install\n```\n\n### 2. ç¯å¢ƒé…ç½®\n\nå¤åˆ¶ `.env.example` ä¸º `.env` å¹¶é…ç½®ï¼š\n\n```env\nPORT=3001\nDB_HOST=localhost\nDB_USER=root\nDB_PASSWORD=&*&Ddasd123.ii2\nDB_NAME=web3\nCONTRACT_ADDRESS=0xdDD30BD07C402eE78079c35A7DE2F9232ed54Aa4\nRPC_URL=http://localhost:8545\n```\n\n### 3. æ•°æ®åº“åˆå§‹åŒ–å’Œç§å­æ•°æ®\n\n**é€‰é¡¹ A: å®Œæ•´è®¾ç½®ï¼ˆæ¨èï¼‰**\n```bash\nnpm run setup\n```\n\n**é€‰é¡¹ B: åˆ†æ­¥éª¤è®¾ç½®**\n```bash\n# åˆ›å»ºæ•°æ®åº“è¡¨\nnpm run migrate\n\n# æ’å…¥æµ‹è¯•æ•°æ®\nnpm run seed\n```\n\n### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨\n\n```bash\nnpm run dev\n```\n\næœåŠ¡å°†è¿è¡Œåœ¨ http://localhost:3001\n\n### 5. æ„å»ºç”Ÿäº§ç‰ˆæœ¬\n\n```bash\nnpm run build\nnpm start\n```\n\n## API æ¥å£\n\n### è¯¾ç¨‹ç›¸å…³\n\n- `GET /api/courses` - è·å–æ‰€æœ‰è¯¾ç¨‹\n- `GET /api/courses/:id` - è·å–æŒ‡å®šè¯¾ç¨‹\n- `GET /api/courses/count` - è·å–è¯¾ç¨‹æ€»æ•°\n- `GET /api/courses/author/:author` - è·å–ä½œè€…çš„è¯¾ç¨‹\n- `POST /api/courses/sync` - åŒæ­¥æ™ºèƒ½åˆçº¦æ•°æ®\n\n### è´­ä¹°ç›¸å…³\n\n- `GET /api/courses/purchased/:userAddress` - è·å–ç”¨æˆ·è´­ä¹°çš„è¯¾ç¨‹\n- `GET /api/courses/purchased/:courseId/:userAddress` - æ£€æŸ¥è´­ä¹°çŠ¶æ€\n- `POST /api/courses/purchase` - è®°å½•è´­ä¹°äº¤æ˜“\n\n### å¥åº·æ£€æŸ¥\n\n- `GET /health` - æœåŠ¡çŠ¶æ€æ£€æŸ¥\n\n## æ™ºèƒ½åˆçº¦é›†æˆ\n\nåç«¯æœåŠ¡é€šè¿‡ ethers.js ä¸æ™ºèƒ½åˆçº¦äº¤äº’ï¼š\n\n- åˆçº¦åœ°å€ï¼š`0xdDD30BD07C402eE78079c35A7DE2F9232ed54Aa4`\n- æ”¯æŒè¯»å–è¯¾ç¨‹ä¿¡æ¯\n- æ”¯æŒæŸ¥è¯¢ç”¨æˆ·è´­ä¹°è®°å½•\n- è‡ªåŠ¨åŒæ­¥åˆçº¦æ•°æ®åˆ°æ•°æ®åº“\n- **æ™ºèƒ½æ•…éšœè½¬ç§»**ï¼šå¦‚æœåˆçº¦ä¸å¯ç”¨ï¼Œè‡ªåŠ¨ä½¿ç”¨æ•°æ®åº“åå¤‡\n\n## æµ‹è¯•æ•°æ®\n\nè¿è¡Œ `npm run seed` åï¼Œç³»ç»Ÿä¼šæ’å…¥ä»¥ä¸‹æµ‹è¯•æ•°æ®ï¼š\n\n### ç¤ºä¾‹è¯¾ç¨‹\n1. **Web3 å¼€å‘å…¥é—¨** - 0.1 ETH\n2. **DeFi åè®®æ·±åº¦è§£æ** - 0.2 ETH  \n3. **NFT å¸‚åœºå¼€å‘å®æˆ˜** - 0.15 ETH\n4. **Solidity é«˜çº§ç¼–ç¨‹æŠ€å·§** - 0.25 ETH\n5. **Layer 2 æ‰©å®¹æ–¹æ¡ˆè¯¦è§£** - 0.18 ETH\n\n### ç¤ºä¾‹ç”¨æˆ·åœ°å€\n- `0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266`\n- `0x70997970C51812dc3A010C7d01b50e0d17dc79C8`\n- `0x742d35Cc6634C0532925a3b8D65aEd2934C12D5e`\n\n## æ•…éšœæ’é™¤\n\n### å¸¸è§é—®é¢˜\n\n1. **æ•°æ®åº“è¿æ¥å¤±è´¥**\n   ```bash\n   # æ£€æŸ¥ MySQL æœåŠ¡çŠ¶æ€\n   sudo systemctl status mysql\n   \n   # å¯åŠ¨ MySQLï¼ˆå¦‚éœ€è¦ï¼‰\n   sudo systemctl start mysql\n   ```\n\n2. **\"Database not initialized\" é”™è¯¯**\n   ```bash\n   # é‡æ–°è¿è¡Œè¿ç§»\n   npm run migrate\n   ```\n\n3. **æ™ºèƒ½åˆçº¦è¿æ¥å¤±è´¥**\n   - ç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨æ•°æ®åº“åå¤‡\n   - æ£€æŸ¥ RPC_URL é…ç½®\n   - éªŒè¯åˆçº¦åœ°å€\n\n### æµ‹è¯• API ç«¯ç‚¹\n\n```bash\n# è·å–æ‰€æœ‰è¯¾ç¨‹\ncurl http://localhost:3001/api/courses\n\n# è·å–ç‰¹å®šç”¨æˆ·çš„å·²è´­è¯¾ç¨‹\ncurl http://localhost:3001/api/courses/purchased/0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\n\n# å¥åº·æ£€æŸ¥\ncurl http://localhost:3001/health\n```\n\n## æ•°æ®åº“ç»“æ„\n\n### courses è¡¨\n\n- `id` - è‡ªå¢ä¸»é”®\n- `course_id` - æ™ºèƒ½åˆçº¦ä¸­çš„è¯¾ç¨‹ID\n- `title` - è¯¾ç¨‹æ ‡é¢˜\n- `description` - è¯¾ç¨‹æè¿°\n- `author` - ä½œè€…åœ°å€\n- `price` - è¯¾ç¨‹ä»·æ ¼ï¼ˆweiï¼‰\n- `created_at` - åˆ›å»ºæ—¶é—´æˆ³\n- `updated_at` - æ›´æ–°æ—¶é—´\n\n### purchases è¡¨\n\n- `id` - è‡ªå¢ä¸»é”®\n- `course_id` - è¯¾ç¨‹ID\n- `buyer` - è´­ä¹°è€…åœ°å€\n- `price` - è´­ä¹°ä»·æ ¼\n- `transaction_hash` - äº¤æ˜“å“ˆå¸Œ\n- `purchased_at` - è´­ä¹°æ—¶é—´\n\n## å¼€å‘è¯´æ˜\n\n### é¡¹ç›®ç»“æ„\n\n```\nsrc/\nâ”œâ”€â”€ controllers/     # æ§åˆ¶å™¨\nâ”œâ”€â”€ services/       # ä¸šåŠ¡é€»è¾‘æœåŠ¡\nâ”œâ”€â”€ routes/         # è·¯ç”±é…ç½®\nâ”œâ”€â”€ database/       # æ•°æ®åº“é…ç½®\nâ”‚   â”œâ”€â”€ connection.ts  # æ•°æ®åº“è¿æ¥\nâ”‚   â”œâ”€â”€ migrate.ts     # æ•°æ®åº“è¿ç§»\nâ”‚   â””â”€â”€ seed.ts        # æµ‹è¯•æ•°æ®\nâ”œâ”€â”€ contracts/      # æ™ºèƒ½åˆçº¦äº¤äº’\nâ”œâ”€â”€ types/          # TypeScript ç±»å‹å®šä¹‰\nâ””â”€â”€ index.ts        # åº”ç”¨å…¥å£\n```\n\n### è„šæœ¬å‘½ä»¤\n\n- `npm run dev` - å¼€å‘æ¨¡å¼è¿è¡Œ\n- `npm run build` - æ„å»ºé¡¹ç›®\n- `npm start` - ç”Ÿäº§æ¨¡å¼è¿è¡Œ\n- `npm run migrate` - æ•°æ®åº“è¿ç§»\n- `npm run seed` - æ’å…¥æµ‹è¯•æ•°æ®\n- `npm run setup` - å®Œæ•´åˆå§‹åŒ–ï¼ˆè¿ç§»+ç§å­æ•°æ®ï¼‰\n\n## éƒ¨ç½²æŒ‡å—\n\n### Docker éƒ¨ç½²\n\n```dockerfile\nFROM node:16-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm ci --only=production\nCOPY . .\nRUN npm run build\nEXPOSE 3001\nCMD [\"npm\", \"start\"]\n```\n\n### ç¯å¢ƒå˜é‡\n\nç¡®ä¿ç”Ÿäº§ç¯å¢ƒé…ç½®æ­£ç¡®çš„ç¯å¢ƒå˜é‡ï¼š\n\n- `PORT` - æœåŠ¡ç«¯å£\n- `DB_HOST` - æ•°æ®åº“ä¸»æœº\n- `DB_USER` - æ•°æ®åº“ç”¨æˆ·\n- `DB_PASSWORD` - æ•°æ®åº“å¯†ç \n- `DB_NAME` - æ•°æ®åº“åç§°\n- `CONTRACT_ADDRESS` - æ™ºèƒ½åˆçº¦åœ°å€\n- `RPC_URL` - åŒºå—é“¾RPCåœ°å€\n\n## æ¶æ„ç‰¹ç‚¹\n\n### æ™ºèƒ½æ•…éšœè½¬ç§»\n\nç³»ç»Ÿè®¾è®¡äº†æ™ºèƒ½çš„æ•…éšœè½¬ç§»æœºåˆ¶ï¼š\n\n1. **ä¼˜å…ˆä½¿ç”¨æ™ºèƒ½åˆçº¦**ï¼šæ‰€æœ‰æ•°æ®æŸ¥è¯¢é¦–å…ˆå°è¯•ä»æ™ºèƒ½åˆçº¦è·å–\n2. **è‡ªåŠ¨æ•°æ®åº“åå¤‡**ï¼šå½“åˆçº¦ä¸å¯ç”¨æ—¶ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°æ•°æ®åº“æŸ¥è¯¢\n3. **æ•°æ®åŒæ­¥**ï¼šåˆçº¦å¯ç”¨æ—¶è‡ªåŠ¨åŒæ­¥æ•°æ®åˆ°æ•°æ®åº“\n4. **æ— ç¼åˆ‡æ¢**ï¼šå‰ç«¯æ— éœ€æ„ŸçŸ¥æ•°æ®æºå˜åŒ–\n\n### æ€§èƒ½ä¼˜åŒ–\n\n- æ•°æ®åº“è¿æ¥æ± \n- åˆçº¦è°ƒç”¨ç¼“å­˜\n- é”™è¯¯é‡è¯•æœºåˆ¶\n- è¿æ¥çŠ¶æ€ç›‘æ§\n\n## å®‰å…¨å»ºè®®\n\n- ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨æ•æ„Ÿä¿¡æ¯\n- å¯ç”¨ HTTPS\n- å®æ–½APIé€Ÿç‡é™åˆ¶\n- å®šæœŸæ›´æ–°ä¾èµ–åŒ…\n- ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨\n\n## è´¡çŒ®æŒ‡å—\n\n1. Fork é¡¹ç›®\n2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯\n3. æäº¤æ›´æ”¹\n4. æ¨é€åˆ°åˆ†æ”¯\n5. åˆ›å»º Pull Request\n\n## è®¸å¯è¯\n\nMIT License"